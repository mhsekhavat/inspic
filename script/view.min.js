(function(c){inspic.view={};var f=inspic.model.mainModel;var b={};c("[inspic_tem]").each(function(){var h=c(this);b[h.attr("inspic_tem")]=_.template(h.html())});var e=Backbone.View.extend({tagName:"span",updateValue:function(){this.$("input,select").inspic("val",this.model.get(this.field))},updateDisability:function(){this.$("*").inspic("disabled",this.model.get("isLoading"))},initialize:function(l,k,i){i||(i={});var h=this.model=f;this.field=l;h.on("change:"+l,this.updateValue,this);i.alwaysEnabled||h.on("change:isLoading",this.updateDisability,this);!i.events||(this.events=i.events);this.render(k,i);var m=i.visibilityCriteria;if(m){var j=this.$el;h.autoSubstituteThenCall(m,function(n){j.css("display",inspicEval(n)?"inline":"none")})()}!i.autoSubstituteThenCall||_.each(i.autoSubstituteThenCall,function(o,n){h.autoSubstituteThenCall(n,o,this)()},this);!i.initialize||(i.initialize.call(this,h))},events:{"change input":"onChange","keyup input":"onChange","change select":"onChange"},render:function(j,h){var k=_.pick(h,"text","icon","options");var l={id:_.uniqueId("inspic_"),data:k};l.label=b.label(l);this.$el.html(b[j](l));this.$el.attr("field",this.field);var i=h.width||30;(i=="long")&&(i=250);this.$('input[type="text"]').css("width",i+"px");this.updateValue()},onChange:function(h){inspic.controller.handleDefaultInputFieldChange(this.field,c(h.target).inspic("val"),this,h)}});var g=Backbone.View.extend({initialize:function(){var i=this.model=f;var h=this.$("img.inspic_img");var k=this.$("img.inspic_loading");i.on("change:src",function(){var m=i.get("src");var l=c("<img>").attr("src",m);h.replaceWith(l);h=l;j()},this);function j(){var m=i.get("width");var l=i.get("height");_.isUndefined(m)||(h.css("width",_.isNumber(m)?m/5+"px":"auto"));_.isUndefined(l)||(h.css("height",_.isNumber(l)?l/5+"px":"auto"))}i.on("change:width change:height",j,this);i.on("change:isLoading",function(){var l=i.get("isLoading");if(l){h.hide();k.show()}else{h.show();k.hide()}})}});function a(h){return function i(j){!(j.el)||(j=j.el);c(j).appendTo(h);return i}}function d(){new g({el:c("#inspic_monitor .inspic_screen")});a("#inspic_src")(new e("src","text",{text:"آدرس:",width:"long",events:{"change input":"onChange"}}))(new e("src.bayan.size","select",{text:"اندازه:",options:{"کوچک":"thumb","متوسط":"image_preview","کامل":"view"},visibilityCriteria:"`src.bayan`"}))("<br>")(new e("width","text",{text:"پهنا:"}))(new e("height","text",{text:"ارتفاع:"}))(new e("keep_ratio","checkbox",{text:"حفظ تناسب ابعاد"}))("<br>")(new e("href.type","select",{text:"پیوند:",options:{"بدون پیوند":"none","تصویر":"src","اندازه کامل":"big",url:"url"},autoSubstituteThenCall:{'`src.bayan` && `src.bayan.size`!="view"':function(h){this.$('option[value="big"]')[inspicEval(h)?"show":"hide"]()}}}))(new e("href.url","text",{width:"long",autoSubstituteThenCall:{"`href.type`":function(h){h=='"url"'?this.$("input").css("display","inline").focus().select():this.$("input").hide()}}}))(new e("href","text",{width:"long",alwaysEnabled:true,visibilityCriteria:'`href.type`!="url" && `href.type`!="none"',initialize:function(){this.$("input").inspic("disabled",true)}}))("<br>")(new e("title","text",{text:"عنوان:",width:"long"}))}c(function(){d();inspic.controller.setField("src","img.jpg")})})(jQuery);